"use strict";(self.webpackChunkargon_dashboard_pro_angular=self.webpackChunkargon_dashboard_pro_angular||[]).push([[197],{86197:function(e,t,r){r.r(t),r.d(t,{TeamsModule:function(){return Q}});var o=r(38583),i=r(75690),n=r(63423),a=r(8239),s=r(3679),l=r(22238),m=r(22176),c=r(13506),g=r(37716),u=r(84678),d=r(46524),p=r(44368),f=r(98295),Z=r(49983),h=r(67441),b=r(72458);function A(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"ngx-dropzone-image-preview",30),g.NdJ("removed",function(){const t=g.CHM(e).$implicit;return g.oxw().onRemove(t[0])}),g.qZA()}2&e&&g.Q6J("file",t.$implicit[0])("removable",!0)}function T(e,t){1&e&&(g.TgZ(0,"mat-error"),g._uU(1," Campo obligatorio "),g.qZA())}function q(e,t){1&e&&(g.TgZ(0,"mat-error"),g._uU(1," Campo obligatorio "),g.qZA())}function x(e,t){1&e&&(g.TgZ(0,"mat-error"),g._uU(1," Campo obligatorio "),g.qZA())}function v(e,t){1&e&&(g.TgZ(0,"mat-error"),g._uU(1," Campo obligatorio "),g.qZA())}function w(e,t){1&e&&(g.TgZ(0,"mat-error"),g._uU(1," Campo obligatorio "),g.qZA())}function U(e,t){1&e&&(g.TgZ(0,"mat-error"),g._uU(1," Campo obligatorio "),g.qZA())}function F(e,t){1&e&&(g.TgZ(0,"mat-error"),g._uU(1," Campo obligatorio "),g.qZA())}function _(e,t){1&e&&(g.TgZ(0,"mat-error"),g._uU(1," Campo obligatorio "),g.qZA())}let N=(()=>{class e{constructor(e,t,r,o,i,n){this.dialogRef=e,this.dialog=t,this.data=r,this.fb=o,this.api=i,this.events=n,this.title="",this.filesControl=new s.NI(null,c.Fz.filesLimit(1)),this.files=[],e.disableClose=!0,this.title=r.title,this.team=r.team}ngOnInit(){this.createForm()}createForm(){this.form=this.fb.group({name:["Agregar"===this.title?"":this.team.name,[s.kI.required]],licenseStart:["Agregar"===this.title?"":new Date(Date.parse(this.team.licenseStart)).toISOString().substring(0,10),[s.kI.required]],licenseEnd:["Agregar"===this.title?"":new Date(Date.parse(this.team.licenseEnd)).toISOString().substring(0,10),[s.kI.required]],maxPlants:["Agregar"===this.title?"":this.team.maxPlants,[s.kI.required]],maxButtons:["Agregar"===this.title?"":this.team.maxButtons,[s.kI.required]],maxUsers:["Agregar"===this.title?"":this.team.maxUsers,[s.kI.required]],radius:["Agregar"===this.title?"":this.team.radius,[s.kI.required]],company:["Agregar"===this.title?"":this.team.company,[s.kI.required]],image:["Agregar"===this.title?"":this.team.image],imgName:["Agregar"===this.title?"":"tiene valor",s.kI.required]})}onSelect(e){this.files[0]=e.addedFiles,this.filesControl=new s.NI(this.files[0],c.Fz.filesLimit(1)),this.form.get("image").setValue(this.filesControl),this.form.get("imgName").setValue("tiene valor")}onRemove(e){this.files.splice(this.files.indexOf(e),1),this.filesControl=new s.NI("",c.Fz.filesLimit(1)),this.form.get("image").setValue(this.filesControl),this.form.get("imgName").setValue("")}configTeams(){"Editar"===this.title?this.putTeams():this.postTeams()}postTeams(){var e=this;return(0,a.Z)(function*(){if(e.form.value.image&&e.form.value.image.value&&e.form.value.image.value[0]){const t=yield e.convertFile(e.form.value.image.value[0]);e.form.get("image").setValue(t)}e.api.postTeams(e.form.value).subscribe({next:t=>{(0,m.w)("success","Correcto","Team creado correctamente","btn btn-fill btn-info").then(t=>{e.close()})},error:e=>{e.error.message.message.includes("name is already in use")?(0,m.w)("error","Error","El nombre proporcionado ya est\xe1 registrado en el sistema. Por favor, ingresa un nombre diferente.","btn btn-info"):(0,m.w)("error","Error","Algo ha salido mal, por favor int\xe9ntalo de nuevo m\xe1s tarde.","btn btn-info")}})})()}putTeams(){var e=this;return(0,a.Z)(function*(){if(e.form.value.image&&e.form.value.image.value&&e.form.value.image.value[0]){const t=yield e.convertFile(e.form.value.image.value[0]);e.form.get("image").setValue(t)}e.api.putTeams(e.form.value,e.team._id).subscribe({next:t=>{(0,m.w)("success","Correcto","Team actualizado correctamente","btn btn-fill btn-info").then(t=>{e.close()})},error:e=>{e.error.message.message.includes("name is already in use")?(0,m.w)("error","Error","El nombre proporcionado ya est\xe1 registrado en el sistema. Por favor, ingresa un nombre diferente.","btn btn-info"):(0,m.w)("error","Error","Algo ha salido mal, por favor int\xe9ntalo de nuevo m\xe1s tarde.","btn btn-info")}})})()}convertFile(e){return new Promise((t,r)=>{const o=new FileReader;o.onload=()=>{const e=btoa(o.result);t(e)},o.onerror=()=>{r("Error al leer el archivo.")},e.type.match(/image.*/)?o.readAsBinaryString(e):r("El archivo seleccionado no es una imagen.")})}convertFileExist(e){let t;fetch(e).then(e=>e.blob()).then(e=>{const r=new FileReader;r.readAsDataURL(e),r.onloadend=()=>{t=String(r.result),this.sendFileToOnSelect(t)}}).catch(e=>{})}sendFileToOnSelect(e){const t=atob(e.split(",")[1]),r=new Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);const o=new Uint8Array(r),i=new Blob([o],{type:"image/jpeg"});let n={addedFiles:[new File([i],"nombre_archivo.jpg",{type:"image/jpeg"})]};this.onSelect(n)}get errorsForm(){return this.form.controls}close(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(l.so),g.Y36(l.uw),g.Y36(l.WI),g.Y36(s.qu),g.Y36(u.s),g.Y36(d.ju))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-add-teams"]],decls:72,vars:13,consts:[[1,"modal-header1","text-left","row","mb-1"],[1,"modal-title"],["type","button",1,"close","mt--5","mr--2",3,"click"],[1,"fa","fa-times","icon-modal-close"],[1,"mat-typography"],["autocomplete","off",1,"form-horizontal",3,"formGroup"],[1,"row"],[1,"col-md-12"],[1,"col-xs-12","col-sm-12","col-md-12"],["ngx-dropzone","",1,"custom-dropzone-p",3,"accept","change"],["src","assets/img/icons/upload.png","width","64px","height","64px","alt","Imagen del team"],[2,"color","#000"],["class","center","id","preview","ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable","removed",4,"ngFor","ngForOf"],["type","hidden","required","","formControlName","imgName","id","imgName","name","imgName"],["appearance","outline",1,"col-xs-12","col-sm-4","col-md-4",2,"border","2px #000000"],["matInput","","name","name","formControlName","name","oninput","javascript:this.value=this.value.toUpperCase();"],[4,"ngIf"],["type","date","matInput","","name","licenseStart","formControlName","licenseStart"],["type","date","matInput","","name","licenseEnd","formControlName","licenseEnd"],["appearance","outline",1,"col-xs-12","col-sm-2","col-md-2",2,"border","2px #000000"],["type","number","matInput","","name","maxPlants","formControlName","maxPlants"],["type","number","matInput","","name","maxButtons","formControlName","maxButtons"],["type","number","matInput","","name","maxUsers","formControlName","maxUsers"],["type","number","matInput","","name","radius","formControlName","radius"],["name","company","formControlName","company"],["value",""],["value","ABIC"],["value","SHADOW"],["mat-dialog-actions","","align","end",1,"dialog-footer"],["type","button",1,"btn","btn-fill","btn-info","btn-md",3,"disabled","click"],["id","preview","ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],1,"center",3,"file","removable","removed"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g.TgZ(1,"h6",1),g._uU(2),g.qZA(),g.TgZ(3,"button",2),g.NdJ("click",function(){return t.close()}),g._UZ(4,"i",3),g.qZA(),g.qZA(),g.TgZ(5,"mat-dialog-content",4),g.TgZ(6,"form",5),g.TgZ(7,"div",6),g.TgZ(8,"div",7),g.TgZ(9,"div",6),g.TgZ(10,"div",8),g.TgZ(11,"div",9),g.NdJ("change",function(e){return t.onSelect(e)}),g.TgZ(12,"ngx-dropzone-label"),g.TgZ(13,"div"),g._UZ(14,"img",10),g.TgZ(15,"h6",11),g._uU(16,"Subir imagen del team"),g.qZA(),g.qZA(),g.qZA(),g.YNc(17,A,1,2,"ngx-dropzone-image-preview",12),g.qZA(),g._UZ(18,"input",13),g.qZA(),g.qZA(),g._UZ(19,"br"),g.TgZ(20,"div",6),g.TgZ(21,"mat-form-field",14),g.TgZ(22,"mat-label"),g._uU(23,"Nombre"),g.qZA(),g._UZ(24,"input",15),g.YNc(25,T,2,0,"mat-error",16),g.qZA(),g.TgZ(26,"mat-form-field",14),g.TgZ(27,"mat-label"),g._uU(28,"Inicio Licencia"),g.qZA(),g._UZ(29,"input",17),g.YNc(30,q,2,0,"mat-error",16),g.qZA(),g.TgZ(31,"mat-form-field",14),g.TgZ(32,"mat-label"),g._uU(33,"Fin Licencia"),g.qZA(),g._UZ(34,"input",18),g.YNc(35,x,2,0,"mat-error",16),g.qZA(),g.qZA(),g._UZ(36,"br"),g.TgZ(37,"div",6),g.TgZ(38,"mat-form-field",19),g.TgZ(39,"mat-label"),g._uU(40,"M\xe1ximo centrales"),g.qZA(),g._UZ(41,"input",20),g.YNc(42,v,2,0,"mat-error",16),g.qZA(),g.TgZ(43,"mat-form-field",19),g.TgZ(44,"mat-label"),g._uU(45,"M\xe1ximo botones"),g.qZA(),g._UZ(46,"input",21),g.YNc(47,w,2,0,"mat-error",16),g.qZA(),g.TgZ(48,"mat-form-field",19),g.TgZ(49,"mat-label"),g._uU(50,"M\xe1ximo usuarios"),g.qZA(),g._UZ(51,"input",22),g.YNc(52,U,2,0,"mat-error",16),g.qZA(),g.TgZ(53,"mat-form-field",19),g.TgZ(54,"mat-label"),g._uU(55,"Radio cobertura (m)"),g.qZA(),g._UZ(56,"input",23),g.YNc(57,F,2,0,"mat-error",16),g.qZA(),g.TgZ(58,"mat-form-field",14),g.TgZ(59,"mat-label"),g._uU(60,"Compania"),g.qZA(),g.TgZ(61,"mat-select",24),g.TgZ(62,"mat-option",25),g._uU(63," Seleccionar "),g.qZA(),g.TgZ(64,"mat-option",26),g._uU(65," ABIC "),g.qZA(),g.TgZ(66,"mat-option",27),g._uU(67," SHADOW "),g.qZA(),g.qZA(),g.YNc(68,_,2,0,"mat-error",16),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(69,"div",28),g.TgZ(70,"button",29),g.NdJ("click",function(){return t.configTeams()}),g._uU(71," Guardar "),g.qZA(),g.qZA()),2&e&&(g.xp6(2),g.hij("",t.title," Team"),g.xp6(4),g.Q6J("formGroup",t.form),g.xp6(5),g.Q6J("accept","image/*"),g.xp6(6),g.Q6J("ngForOf",t.files),g.xp6(8),g.Q6J("ngIf",t.errorsForm.name.touched&&(null==t.errorsForm.name.errors?null:t.errorsForm.name.errors.required)),g.xp6(5),g.Q6J("ngIf",t.errorsForm.licenseStart.touched&&(null==t.errorsForm.licenseStart.errors?null:t.errorsForm.licenseStart.errors.required)),g.xp6(5),g.Q6J("ngIf",t.errorsForm.licenseEnd.touched&&(null==t.errorsForm.licenseEnd.errors?null:t.errorsForm.licenseEnd.errors.required)),g.xp6(7),g.Q6J("ngIf",t.errorsForm.maxPlants.touched&&(null==t.errorsForm.maxPlants.errors?null:t.errorsForm.maxPlants.errors.required)),g.xp6(5),g.Q6J("ngIf",t.errorsForm.maxButtons.touched&&(null==t.errorsForm.maxButtons.errors?null:t.errorsForm.maxButtons.errors.required)),g.xp6(5),g.Q6J("ngIf",t.errorsForm.maxUsers.touched&&(null==t.errorsForm.maxUsers.errors?null:t.errorsForm.maxUsers.errors.required)),g.xp6(5),g.Q6J("ngIf",t.errorsForm.radius.touched&&(null==t.errorsForm.radius.errors?null:t.errorsForm.radius.errors.required)),g.xp6(11),g.Q6J("ngIf",t.errorsForm.company.touched&&(null==t.errorsForm.company.errors?null:t.errorsForm.company.errors.required)),g.xp6(2),g.Q6J("disabled",!t.form.valid))},directives:[l.xY,s._Y,s.JL,s.sg,p._f,p.Jj,o.sg,s.Fj,s.Q7,s.JJ,s.u,f.KE,f.hX,Z.Nt,o.O5,s.wV,h.gD,b.ey,l.H8,p.sv,f.TO],styles:[".general[_ngcontent-%COMP%]{position:relative;margin:auto;width:250px;height:250px}.picture[_ngcontent-%COMP%]{position:absolute;right:20px;top:20px;width:200px;height:200px}"]}),e})();var I=r(99692);function y(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"a",25),g.NdJ("click",function(){g.CHM(e);const t=g.oxw().$implicit;return g.oxw(2).openModal("Editar",t)}),g._UZ(1,"i",26),g.qZA()}}function C(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"a",27),g.NdJ("click",function(){g.CHM(e);const t=g.oxw().$implicit;return g.oxw(2).showUsers(t)}),g._UZ(1,"i",28),g.qZA()}}function J(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"tr"),g.TgZ(1,"td",19),g._uU(2),g.qZA(),g.TgZ(3,"td",20),g.TgZ(4,"a",21),g.NdJ("click",function(){const t=g.CHM(e).$implicit;return g.oxw(2).showPlants(t)}),g._UZ(5,"i",22),g.qZA(),g.YNc(6,y,2,0,"a",23),g.YNc(7,C,2,0,"a",24),g.qZA(),g.qZA()}if(2&e){const e=t.$implicit,r=g.oxw(2);g.xp6(2),g.Oqu(e.name),g.xp6(4),g.Q6J("ngIf","SUPER-ADMIN"===r.role),g.xp6(1),g.Q6J("ngIf","SUPER-ADMIN"===r.role)}}function S(e,t){if(1&e&&(g.TgZ(0,"tbody"),g.YNc(1,J,8,3,"tr",18),g.qZA()),2&e){const e=g.oxw();g.xp6(1),g.Q6J("ngForOf",e.teams)}}function E(e,t){1&e&&(g.TgZ(0,"p",29),g._uU(1,"No existen registros"),g.qZA())}function k(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",1),g.TgZ(1,"div",2),g.TgZ(2,"div",30),g.TgZ(3,"mat-paginator",31,32),g.NdJ("page",function(t){return g.CHM(e),g.oxw().changePage(t)}),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&e){const e=g.oxw();g.xp6(3),g.Q6J("length",null==e.pagination?null:e.pagination.total)("pageSize",null==e.pagination?null:e.pagination.itemsPage)}}function Y(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"button",33),g.NdJ("click",function(){return g.CHM(e),g.oxw().openModal("Agregar")}),g._UZ(1,"img",34),g.qZA()}}const P=[{path:"",children:[{path:"",component:(()=>{class e{constructor(e,t,r,o){this.dialog=e,this.fb=t,this.api=r,this.router=o,this.teams=[],this.pagination={page:1,pages:1,itemsPage:10,total:1},this.wordToSearch="",this.count=0,this.role=""}ngOnInit(){this.role=localStorage.getItem("role"),this.createForm(),this.getTeams()}createForm(){this.searchForm=this.fb.group({value:[""]})}getTeams(){this.wordToSearch=this.searchForm.value.value,this.api.getTeams(this.pagination.page,this.pagination.itemsPage,this.wordToSearch).subscribe({next:e=>{this.teams=e.body.teams,this.pagination=e.body.pagination,this.count=e.body.pagination.total},error:e=>{(0,m.w)("error","Error","Algo ha salido mal, intente m\xe1s tarde!","btn btn-info")}})}openModal(e,t){this.dialog.open(N,{width:"800px",data:{title:e,team:t}}).afterClosed().subscribe(e=>{this.getTeams()})}showPlants(e){let t=btoa(JSON.stringify({id:e._id,name:e.name}));this.router.navigate(["neighborhoods/"+t])}showUsers(e){let t=btoa(JSON.stringify({id:e._id,name:e.name}));this.router.navigate(["operator-team/"+t])}changePage(e){this.pagination.page=e.pageIndex+1,this.getTeams()}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(l.uw),g.Y36(s.qu),g.Y36(u.s),g.Y36(n.F0))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-teams"]],decls:32,vars:6,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"header"],[1,"title"],[1,"category"],[1,"form-horizontal",3,"formGroup"],["appearance","outline",1,"col-xs-12","col-sm-12","col-md-12",2,"border","2px #000000"],["matInput","","name","value","formControlName","value",3,"keyup"],[1,"content","table-responsive","table-full-width"],[1,"table"],[1,"text-right"],[4,"ngIf"],["class","msg-empty",4,"ngIf"],["class","container-fluid",4,"ngIf"],["id","addBtn","class","btn btn-icon btn-round btn-twitter",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"td-size"],[1,"td-actions","text-right"],["rel","tooltip","title","Ver Centrales",1,"btn","btn-primary","btn-simple","btn-xs",3,"click"],[1,"fa","fa-eye"],["rel","tooltip","title","Editar","class","btn btn-warning btn-simple btn-xs",3,"click",4,"ngIf"],["rel","tooltip","title","Ver Operadores","class","btn btn-info btn-simple btn-xs",3,"click",4,"ngIf"],["rel","tooltip","title","Editar",1,"btn","btn-warning","btn-simple","btn-xs",3,"click"],[1,"fa","fa-edit"],["rel","tooltip","title","Ver Operadores",1,"btn","btn-info","btn-simple","btn-xs",3,"click"],[1,"fa","fa-users"],[1,"msg-empty"],[1,"col","d-flex","justify-content-end"],["showFirstLastButtons","",3,"length","pageSize","page"],["paginator",""],["id","addBtn",1,"btn","btn-icon","btn-round","btn-twitter",3,"click"],["src","assets/img/icons/mas.png"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"div",3),g.TgZ(4,"div",4),g.TgZ(5,"div",5),g.TgZ(6,"h4",6),g._uU(7),g.qZA(),g._UZ(8,"p",7),g.qZA(),g._UZ(9,"br"),g.TgZ(10,"form",8),g.TgZ(11,"div",3),g.TgZ(12,"div",2),g.TgZ(13,"mat-form-field",9),g.TgZ(14,"mat-label"),g._uU(15,"Buscar por nombre"),g.qZA(),g.TgZ(16,"input",10),g.NdJ("keyup",function(){return t.getTeams()}),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g._UZ(17,"br"),g.TgZ(18,"div",11),g.TgZ(19,"table",12),g.TgZ(20,"thead"),g.TgZ(21,"tr"),g.TgZ(22,"th"),g._uU(23,"Nombre"),g.qZA(),g.TgZ(24,"th",13),g._uU(25,"Acciones"),g.qZA(),g.qZA(),g.qZA(),g.YNc(26,S,2,1,"tbody",14),g.qZA(),g.YNc(27,E,2,0,"p",15),g.qZA(),g._UZ(28,"br"),g.YNc(29,k,5,2,"div",16),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(30,"caption"),g.YNc(31,Y,2,0,"button",17),g.qZA()),2&e&&(g.xp6(7),g.hij("Teams: ",t.count,""),g.xp6(3),g.Q6J("formGroup",t.searchForm),g.xp6(16),g.Q6J("ngIf",t.count>0),g.xp6(1),g.Q6J("ngIf",0===t.count),g.xp6(2),g.Q6J("ngIf",0!==t.count),g.xp6(2),g.Q6J("ngIf","SUPER-ADMIN"===t.role))},directives:[s._Y,s.JL,s.sg,f.KE,f.hX,Z.Nt,s.Fj,s.JJ,s.u,o.O5,o.sg,I.NW],styles:[""]}),e})()}]}];var O=r(12640);let Q=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({providers:[d.ju],imports:[[o.ez,s.u5,s.UX,i.P4.forRoot(),n.Bz.forChild(P),O.q,p.bB]]}),e})()}}]);